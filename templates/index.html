<!DOCTYPE html>
<html>
<head>
    <title>PDF to Image Converter</title>
</head>
<body>
    <h1>PDF to Image Converter</h1>
    <input type="file" id="pdfFile" accept=".pdf">
    <button id="convertButton">Convert to Image</button>
    <div id="imageContainer">
        {% if image %}
            <button id="downloadButton">Download Image</button>
        {% endif %}
    </div>

    <script>
        document.getElementById('convertButton').addEventListener('click', function() {
            const file = document.getElementById('pdfFile').files[0];
            if (file) {
                const formData = new FormData();
                formData.append('file', file);

                fetch('http://127.0.0.1:8000/pdf_to_image/', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.text())
                .then(html => {
                    document.documentElement.innerHTML = html;
                })
                .catch(error => {
                    console.error('Error:', error);
                });
            } else {
                alert('Please select a PDF file.');
            }
        });

        document.addEventListener('click', function(event) {
          if (event.target && event.target.id === 'downloadButton') {
            const imageData = document.querySelector('button#downloadButton').parentElement.dataset.image;
            const link = document.createElement('a');
            link.href = 'data:image/jpeg;base64,' + imageData;
            link.download = 'converted_image.jpg';
            link.click();
          }
        });
    </script>
</body>
</html>